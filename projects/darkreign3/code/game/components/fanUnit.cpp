#include "game/components/fanUnit.hpp"
#include "engine/fanEngineSerializable.hpp"

namespace fan
{

    //==================================================================================================================================================================================================
    //==================================================================================================================================================================================================
    void Unit::SetInfo( EcsComponentInfo& _info )
    {
        _info.load = &Unit::Load;
        _info.save = &Unit::Save;
    }

    //==================================================================================================================================================================================================
    //==================================================================================================================================================================================================
    void Unit::Init( EcsWorld& /*_world*/, EcsEntity /*_entity*/, EcsComponent& _component )
    {
        Unit& unit = static_cast<Unit&>( _component );
        unit.mAttackRange   = 1;
        unit.mState         = State::Wait;
        unit.mLastOrder     = {};
    }

    //==================================================================================================================================================================================================
    //==================================================================================================================================================================================================
    void Unit::Save( const EcsComponent& _component, Json& _json )
    {
        const Unit& unit = static_cast<const Unit&>( _component );
        Serializable::SaveFixed( _json, "attack_range", unit.mAttackRange );
    }

    //==================================================================================================================================================================================================
    //==================================================================================================================================================================================================
    void Unit::Load( EcsComponent& _component, const Json& _json )
    {
        Unit& unit = static_cast<Unit&>( _component );
        Serializable::LoadFixed( _json, "attack_range", unit.mAttackRange );
    }
}